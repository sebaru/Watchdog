;-----------------------------------------------------------------------------------------------------------
; interruption.asm    Vecteurs d'interruption
; Sébastien Lefevre                                                            mar 08 jun 2004 12:49:36 CEST 
;-----------------------------------------------------------------------------------------------------------
        .module Interruption
        .include "cst.asm"
;-----------------------------------------------------------------------------------------------------------
; interrupt vector 
;-----------------------------------------------------------------------------------------------------------
	.area INTSEG    (ABS)
	.org #0x0000
_int:	ljmp _start
	.org #0x0003
	reti                  ; IRQ1   INT0         IE0       0003H

;-----------------------------------------------------------------------------------------------------------
; IRQ 2: interruption timer 0: Purge de la trame RS232
;-----------------------------------------------------------------------------------------------------------
	.org #0x000B          ; IRQ2   TIMER 0      TF0       000BH
        lcall _rs232_purge_trame
	reti        

	.org #0x0013
	reti                  ; IRQ3   INT1         IE1       0013H

;-----------------------------------------------------------------------------------------------------------
; IRQ 4: interruption timer 1: Utilisé pour la communication RS232
;-----------------------------------------------------------------------------------------------------------
	.org #0x001B
	reti                  ; IRQ4   TIMER 1      TF1       001BH

;-----------------------------------------------------------------------------------------------------------
; IRQ 5: interruption ligne rs232
;-----------------------------------------------------------------------------------------------------------
	.org #0x0023
        jnb  RI,_end_int_rs232
        lcall _recu_rs232   ; si RI=1 saut et mise à 0 de RI
_end_int_rs232:
        reti

	.org #0x002B
	reti                  ; IRQ6   TIMER 2      TF2+EXF2  002BH
	.org #0x0033
	reti                  ; IRQ7
	.org #0x003B
	reti                  ; IRQ8
	.org #0x0043
	reti                  ; IRQ9
	.org #0x004B
	reti                  ; IRQ10
;-----------------------------------------------------------------------------------------------------------
; IRQ 11: interruption C.A.N
;-----------------------------------------------------------------------------------------------------------
	.org #0x0053
        anl ADCON,#0xEF       ; ADCI = 0
        lcall _recu_can       ; si RI=1 saut et mise à 0 de RI
        reti

	.org #0x005B
	reti                  ; IRQ12
	.org #0x0063
	reti                  ; IRQ13
	.org #0x006B
	reti                  ; IRQ14
	.org #0x0073
	reti                  ; IRQ15
;-----------------------------------------------------------------------------------------------------------

